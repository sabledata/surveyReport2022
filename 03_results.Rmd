# Results and Discussion

## FISHING

```{r HistoricText, echo=FALSE}

# taken from field db notes

```
The 2022 survey was 47 days long, starting in Nanaimo, BC on October 4, with crew changes on October 20 at Port Hardy and November 3 at Skidegate Narrows. The survey was completed on November 19 with a loss of 9 weather days.  In total, 97 sets were completed (Appendix \@ref(app:second-appendix)): 86 StRS sets at random sites (Figure \@ref(fig:figure3)), six 60-trap experimental sets for gear movement research (Figure \@ref(fig:figure3)) and five standardized sets at Finlayson inlet locality (Figure \@ref(fig:figure4)). 

Of the 91 original blocks for the StRS portion of the survey, 5 blocks were deemed unfishable due to the weather and timing (Figure \@ref(fig:figure5)). 

```{r CatchRateText, echo=FALSE}
  # -- generate the lowest uncertainity and corresponding year for catch rate paragraph

  dtStRS   <-   " select  * from dbo.GENERIC_GFBIO_TRAPS order by year"  # -- must update view GENERIC_GFBIO_TRAPS
  #datStRS  <-   GetSQLData(dtStRS,"Sablefish")                          # read  from SQL Server
  #write.table(datStRS, file = paste(path,"results01.csv", sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")  
  datStRS  <-  read.csv(paste(path,'results01.csv',sep=''), header=T)  # read from csv
  odbcCloseAll()

  datRD    <-   datStRS[ datStRS$SABLE.SET.TYPE=="StRS", ] # --  pick out the random sets
  dat      <-   datRD[ ! is.na(datRD$SABLE.SET.TYPE), ]
  yrs      <-   unique(datRD$year)   # -- get unique years
  nyrs     <-   length(yrs)
  
  data.cv  <- data.frame( year   <- numeric(),
                          value1 <- numeric(),
                          value2 <- numeric(),
                          value3 <- numeric() )
  
  data.mn <- data.frame(  year   <- numeric(),
                          value1 <- numeric(),
                          value2 <- numeric(),
                          value3 <- numeric() )

  # -- iterate through the years building depth boxplots to get cv's and mean counts
  for (i in 1:nyrs)
     {    yrdat          <- datRD[datRD$year==yrs[i],]      # -- get the year dataset
          bxdat          <- split(yrdat$CPUE.SABLE.COUNT / yrdat$CPUE.TRAPS, as.character(yrdat$SABLE.DEPTH.GROUP))  # split by depth
          dpth.mean      <- sapply(bxdat, mean, na.rm=T)    # -- add the mean by depth  points
          std.dev        <- sapply(bxdat, sd, na.rm=T)
          names(data.cv) <- c("year", "RD1", "RD2", "RD3")  # -- store cv's
          names(data.mn) <- c("year", "RD1", "RD2", "RD3")  # -- store mean counts by depth
          data.cv        <- rbind(data.cv,c(yrs[i],round(std.dev/dpth.mean,2)))
          data.mn        <- rbind(data.mn,c(yrs[i],round(dpth.mean,0)))
      }
  
          RD1.cvlow      <- min(data.cv$RD1)
          RD1.cvlowyr    <- data.cv$year[data.cv$RD1==RD1.cvlow]
          RD2.cvlow      <- min(data.cv$RD2)
          RD2.cvlowyr    <- data.cv$year[data.cv$RD2==RD2.cvlow]
          RD3.cvlow      <- min(data.cv$RD3)
          RD3.cvlowyr    <- data.cv$year[data.cv$RD3==RD3.cvlow]
          
    # -- type data.mn in the Console to view the shallow, middle and deep depth stratums CPUE for 
    # -- descriptive paragraph below
          
    # INLET TEXT for 2018 and 2019          
    cpuedat   <-  read.csv(paste(path,"figure10.csv", sep=''),header=T)

    #pick out the stand sets
    dat         <- cpuedat[ which(cpuedat$SABLE.SET.TYPE=="INLET STANDARDIZED" ), ]
    dat         <- dat[ which(is.na(dat$SABLE.SET.TYPE)==FALSE), ]
    inlet18     <- dat[dat$year == yr,]                                     # text for cpue mean year one
    data18.mn   <- round(mean(inlet18$CPUE.SABLE.COUNT/inlet18$CPUE.TRAPS),0)
    data18kg.mn <- round(mean(inlet18$CPUE.SABLE.WEIGHT/inlet18$CPUE.TRAPS),0)
    data18kg    <- round(mean(inlet18$CPUE.SABLE.WEIGHT/inlet18$CPUE.SABLE.COUNT),1)
    
    inlet19     <- dat[dat$year == yr+1,]                                   # text for cpue mean year two
    data19.mn   <- round(mean(inlet19$CPUE.SABLE.COUNT/inlet19$CPUE.TRAPS),0)
    data19kg.mn <- round(mean(inlet19$CPUE.SABLE.WEIGHT/inlet19$CPUE.TRAPS),0)
    data19kg    <- round(mean(inlet19$CPUE.SABLE.WEIGHT/inlet19$CPUE.SABLE.COUNT),1)
    

  
```
## CATCH PER UNIT EFFORT (CPUE) 

Catch per unit effort (CPUE) statistics for `r yr` are presented in relation to the available time series for each of the survey components used to index abundance:  (i) StRS (2003-`r yr`) and (ii) traditional mainland inlet indexing sites (1991-`r yr`). 

### Stratified Random Set CPUE 

Catch rates (catch per unit effort; CPUE) as indexed by kilograms of Sablefish per trap (Figure \@ref(fig:figure6)) and numbers of fish per trap (Figure \@ref(fig:figure7)) were generally higher in the middle depth strata over the survey time series (2003-`r yr`). 
In `r yr`, the kg/trap and #fish/trap in the middle depth strata (RD~2~) were lower than the peak reached in 2019 in areas S~2~, S~3~, S~4~ and S~5~.  In area S~1~ (South West Coast Vancouver Island), the `r yr` kg/trap and #fish/trap in the middle depth strata (RD~2~) were lower than the peaks reached in 2020 and 2021.

The mean weight of captured Sablefish in `r yr` was similar or slightly higher compared to `r yr-1` in the deep (RD~3~) and middle depth (RD~2~) waters of areas S~2~, S~3~, S~4~ and S~5~.   In the shallow (RD~1~) waters, the mean weight in `r yr` was slightly higher in areas S~2~ and S~4~ (Figure \@ref(fig:figure8)).   

The stratified mean survey abundance in 2022 is up 10% from 2021; the second highest index since 2003. (Figure \@ref(fig:figure9)).

### Mainland Inlet CPUE

CPUE in the mainlaind inlets from has varied over time (1995-2022) with peak CPUE occurring every 5-8 years (Figure \@ref(fig:figure10)). At Dean/Burke Channel, Gil Island and Portland Inlet, the average CPUE peaks were observed in 1999, 2004 (2003 at Portland Inlet), 2011 and 2019.  At Finlayson Channel, the average CPUE peaks were observed in 1999, 2005, 2012 and 2019. 

The highest catch rates of the 26 year time series observed at Dean/Burke Channel, Finlayson Channel, Gil Island, Portland Inlet occurred in 2019 with 42 kg/per trap, 51 kg/per trap, 74 kg/per trap and 75 kg/per trap respectively. No inlets were surveyed in 2020.  Dean/Burke Channel was the only mainland inlet locality surveyed in 2021. Finlayson Inlet was the only mainland inlet locality surveyed in 2022.  

```{r SpeciesCompositionText, echo=FALSE}

  # -- taxonomic top 5 group count StRS
   topStRS      <- paste("select top (5) SPECIES_COMMON_NAME, SPECIES_SCIENCE_NAME, ",
                         "sum(CATCH_WEIGHT) AS catchkg ",
                         "from dbo.GFBIO_RESEARCH_CATCH ",
                         "group by SABLE_SET_TYPE, Year, SPECIES_CODE, ",
                         "SPECIES_COMMON_NAME, SPECIES_SCIENCE_NAME ",
                         "having (SABLE_SET_TYPE = N'StRS') and ",
                         "(SPECIES_CODE <> N'455') and (Year = ",yr,") ",
                         "order by catchkg DESC", sep="") 
   #topStRSsp    <- GetSQLData(topStRS,"Sablefish") 
   #write.table(topStRSsp, file = paste(path,"results02.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")   
   topStRSsp  <-  read.csv(paste(path, 'results02.csv',sep=''), header=T) 
   
   topStRSsp1   <-  stringr::str_to_title(as.character(topStRSsp[1,1]))                     # -- StRS top 5 species names
   topStRSsp1   <- gsub("Complex","complex", topStRSsp1)            # -- small letter on complex if it occurs
   topStRSsp1   <- gsub("Spiny Dogfish","North Pacific Spiny Dogfish", topStRSsp1) # add North Pacific to dogfish name
   topStRSsc1   <- firstup(tolower(as.character(topStRSsp[1,2])))    # -- StRS top 5 species science names
   
   topStRSsp2   <-  stringr::str_to_title(as.character(topStRSsp[2,1]))  
   topStRSsp2   <- gsub("Complex","complex", topStRSsp2)            # -- small letter on complex if it occurs  
   topStRSsc2   <- firstup(tolower(as.character(topStRSsp[2,2])))   
   
   topStRSsp3   <- stringr::str_to_title(as.character(topStRSsp[3,1]))
   topStRSsp3   <- gsub("Complex","complex", topStRSsp3)            # -- small letter on complex if it occurs  
   topStRSsc3   <- firstup(tolower(as.character(topStRSsp[3,2])))
   
   topStRSsp4   <- stringr::str_to_title(as.character(topStRSsp[4,1]) ) 
   topStRSsp4   <- gsub("Complex","complex", topStRSsp4)            # -- small letter on complex if it occurs   
   topStRSsc4   <- firstup(tolower(as.character(topStRSsp[4,2])))  
   
   topStRSsp5   <- stringr::str_to_title(as.character(topStRSsp[5,1]))  
   topStRSsp5   <- gsub("Complex","complex", topStRSsp5)            # -- small letter on complex if it occurs   
   topStRSsc5   <- firstup(tolower(as.character(topStRSsp[5,2])))
   
  # -- taxonomic group count Inlets
   topInlet     <- paste("select top (2) SPECIES_COMMON_NAME, SPECIES_SCIENCE_NAME, sum(CATCH_WEIGHT) AS catchkg ",
                         " from dbo.GFBIO_RESEARCH_CATCH  ",
                         " group by SABLE_SET_TYPE, Year, SPECIES_CODE, SPECIES_COMMON_NAME, SPECIES_SCIENCE_NAME ",
                         " having (SABLE_SET_TYPE = N'INLET STANDARDIZED') and (SPECIES_CODE <> N'455') and (Year = ",yr,") ",
                         " order by catchkg DESC", sep="") 
   
   #topInletsp   <- GetSQLData(topInlet,"Sablefish")   
   #write.table(topInletsp, file = paste(path,"results02b.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")
   topInletsp   <-  read.csv(paste(path, 'results02b.csv',sep=''), header=T)     
   
   
   topInletsp1  <- stringr::str_to_title(as.character(topInletsp[1,1]))    # -- inlet top 2 species names
   # str_to_title() Function in R Language is used to convert the first letter of every word of a string to Uppercase 
   # the rest of the letters are converted to lower case. uses stringr()
   topInletsp1  <- gsub("Complex","complex", topInletsp1)          # -- small letter on complex if it occurs 
   topInletsc1  <- firstup(tolower(as.character(topInletsp[1,2])))  # -- inlet top 2 species science names

   topInletsp2  <- stringr::str_to_title(topInletsp[2,1])  
   topInletsp2  <- tolower(as.character(topInletsp2))
   topInletsc2  <- firstup(tolower(as.character(topInletsp[2,2])))  

 
 # -- species composition counts for StRS sets 
   spc          <- paste("select dbo.fnIntegerToWords(sum(CAST(Roundfish as int))) as tRound,  ",
                                "dbo.fnIntegerToWords(sum(Rockfish))     as tRock,   ",
                                "dbo.fnIntegerToWords(sum(Flatfish))     as tFlat,   ",
                                "dbo.fnIntegerToWords(sum(Invertebrate)) as tInvert, ",
                                "dbo.fnIntegerToWords(sum(Mammal))       as tMammal, ",
                                "dbo.fnIntegerToWords(sum(Bird))         as tBird,   ",
                                "dbo.fnIntegerToWords(sum(counter))      as total    ",
                                "from (select case when Fish = Rockfish or Fish = Flatfish ", 
                                "then 0 ELSE Fish end AS Roundfish, ",
                                "Fish, Rockfish, Flatfish, Invertebrate, Mammal, Bird, ",
                                "SABLE_SET_TYPE, TRIP_ID, 1 AS counter, Year, ",
                                "SPECIES_CODE from dbo.GFBIO_RESEARCH_CATCH ",
                                "group by ",
                                "Fish, Rockfish, Flatfish, Invertebrate, Mammal, Bird, ",
                                "SABLE_SET_TYPE, Year, TRIP_ID,  ",
                                "case when Fish = Rockfish or Fish = Flatfish then 0 ELSE Fish end, SPECIES_CODE  ",
                                "having (SABLE_SET_TYPE = N'StRS') and (Year = ",yr,")) AS RC", sep="")
   #strsSpCom    <- GetSQLData(spc,"Sablefish")
   #write.table(strsSpCom, file = paste(path,"results03.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")   
   strsSpCom   <-  read.csv(paste(path,'results03.csv',sep=''),header=T) 
   
   roundfishS   <- strsSpCom[1,1]
   rockfishS    <- strsSpCom[1,2]
   flatfishS    <- strsSpCom[1,3]
   invertS      <- strsSpCom[1,4]
   mammalS      <- strsSpCom[1,5]
   birdS        <- strsSpCom[1,6]
   totalS      <- firstup(as.character(strsSpCom[1,7])) # taxonomic unit count for StRS with capital
   totalS       <- as.character(strsSpCom[1,7]) # taxonomic unit count for StRS

   # -- species composition counts inlet sets
    spcI          <- paste(" select dbo.fnIntegerToWords(SUM(CAST(Roundfish AS int))) AS tRound,   ",
                           " dbo.fnIntegerToWords(ISNULL(SUM(Rockfish),0))     AS tRock, ",
                           " dbo.fnIntegerToWords(ISNULL(SUM(Flatfish),0))     AS tFlat,    ",
                           " dbo.fnIntegerToWords(ISNULL(SUM(Invertebrate),0)) AS tInvert,  ",
                           " dbo.fnIntegerToWords(ISNULL(SUM(Mammal),0))       AS tMammal,  ",
                           " dbo.fnIntegerToWords(ISNULL(SUM(Bird),0))         AS tBird,    ",
                           " dbo.fnIntegerToWords(SUM(counter))                AS total     ",    
                           " from   (select CASE WHEN Fish = Rockfish or Fish = Flatfish THEN 0 ELSE Fish END AS Roundfish,  ",
                           " Fish, Rockfish, Flatfish, Invertebrate, Mammal, Bird,       ",
                           " SABLE_SET_TYPE, TRIP_ID, 1 AS counter, Year, SPECIES_CODE   ",
                           " from dbo.GFBIO_RESEARCH_CATCH  ",
                           " group by Fish, Rockfish, Flatfish, Invertebrate, Mammal, Bird, SABLE_SET_TYPE, Year, TRIP_ID, ",
                           " CASE WHEN Fish = Rockfish or Fish = Flatfish THEN 0 ELSE Fish END, SPECIES_CODE ",
                           " having (SABLE_SET_TYPE = N'INLET STANDARDIZED')       ",
                           " and (Year = ",yr,")) AS RC",sep="")
   #strsSpComI    <- GetSQLData(spcI,"Sablefish")
   #write.table(strsSpComI, file = paste(path,"results03b.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")   
   strsSpComI   <-  read.csv(paste(path,'results03b.csv',sep=''),header=T) 
   
   roundfishI   <- strsSpComI[1,1]
   rockfishI    <- strsSpComI[1,2]
   flatfishI    <- strsSpComI[1,3]
   invertI      <- strsSpComI[1,4]
   mammalI      <- strsSpComI[1,5]
   birdI        <- strsSpComI[1,6]
   totalI       <- firstup(as.character(strsSpComI[1,7]))       # taxonomic units count for inlets for StRS with capital
   totalI       <- as.character(strsSpComI[1,7])       # taxonomic units count for inlets

```

## CATCH COMPOSITION

A total of `r totalS[1]` taxonomic groups were represented in the  `r yr` catch from StRS sets (Table \@ref(tab:table4)).  These included `r roundfishS[1]` roundfish species, `r rockfishS[1]` rockfish species, `r flatfishS[1]`  flatfish species and `r invertS[1]` invertebrate species. Other than Sablefish, the most common species, by weight,  were  `r topStRSsp1[1]` (*`r topStRSsc1`*), `r topStRSsp2` (*`r topStRSsc2`*), `r topStRSsp3` (*`r topStRSsc3`*) and `r topStRSsp4` (*`r topStRSsc4`*).  

A total of `r totalI` taxonomic groups were represented in the catches from traditional standardized sets conducted in mainland inlet localities in `r yr[1]` (Table \@ref(tab:table5)).  These included `r roundfishI` roundfish species, `r rockfishI`  rockfish species, `r flatfishI` flatfish species and `r invertI` invertebrate species.  The most common species captured, in terms of total weight, other than Sablefish was `r topInletsp1` (*`r topInletsc1`*). 

```{r SamplingWords, echo=FALSE}
    # inline text query Sablefish.dbo.GFBIO_RESEARCH_SAMPLE_DETAILS for the counts of Sablefish from StRS sets
    catchStRS   <- paste("select rt.SABLE_SET_TYPE, ",
                         "sum(sd.[Total Count])                           AS count, ",
                         "sum(sd.[Recovered Number])                      AS tagagainlive, ",
                         "sum(sd.[Recovered Dead Number])                 AS tagdead, ",
                         "sum(sd.[Tagged Number] + sd.[Recovered Number]) AS tagrelease, " ,
                         "sum(sd.[Fork Len Tag Sample Count])             AS taglengthsample,  " ,
                         "sum(sd.Sample_count)                            AS samplecount " ,
                         "from dbo.GFBIO_RESEARCH_SAMPLE_DETAILS AS sd INNER JOIN " ,         
                         "dbo.GFBIO_SABLEBIO_TRIP_SET2 AS rt ON " ,
                         "sd.TRIP_ID = rt.TRIP_ID AND  sd.[SET] = rt.SET_NUMBER " ,
                         "where (sd.Year =", yr,") group by rt.SABLE_SET_TYPE", sep="")

    #countStRS   <- GetSQLData(catchStRS,"Sablefish")
    #write.table(countStRS, file = paste(path,"results04.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",") 
    countStRS   <-  read.csv(paste(path,'results04.csv',sep=''),header=T) 
    
    # -- Sablefish.dbo.procReport_Survey_LenMF pulls length data from table GFBIO_SABLEBIO_VW 
    # -- from procedure Build_BIO_Sablefish_Tables for the histogram of lengths
    
    lendat     <-   "exec procReport_Survey_LenMF"
    #lendata    <-   GetSQLData(lendat,"Sablefish")
    #write.table(lendata, file = paste(path,"results05.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",") 
    lendata   <-    read.csv(paste(path,'results05.csv',sep=''),header=T) 

    # average lengths per year in text
    lenstats  <- "exec procRReport_Survey_LenAvg"
    #dat       <- GetSQLData(lenstats,"Sablefish")
    #write.table(dat, file = paste(path,'results05b.csv',sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",") 
    dat       <- read.csv(paste(path,'results05b.csv',sep=''), header=T)
    
    mavgyr1   <- dat[dat$sex==1 & dat$YEAR==yr,]   # round(mavgyr1$AvL,1)
    favgyr1   <- dat[dat$sex==2 & dat$YEAR==yr,]   # round(favgyr1$AvL,1)
  
    fdat      <- dat[dat$sex==2,]
    mdat      <- dat[dat$sex==1,]
    
    firstyrfem <-   lendata[lendata$year == yr & lendata$sex == 2,] 
    firstyrmal <-   lendata[lendata$year == yr & lendata$sex == 1,] 
    
    lenMF      <-   lendata[lendata$year <= yr,] 
    brk        <-   seq(min(lenMF$length)-1,max(lenMF$length)+1)
    osex       <-   length(lenMF$length[lenMF$sex==3])
    	
    # -- set up the female data
    females  <-   lenMF$length[lenMF$sex==2]
    females  <-   females[!is.na(females)]
    tf       <-   length(females)                                 # -- count female lengths
    mLf      <-   format(round(mean(females,na.rm=T),1),nsmall=1) # -- mean female length
    stdf     <-   round(sd(females),1)                            # -- standard deviation
    	
    #--  set up the male data
    males    <-   lenMF$length[lenMF$sex==1]
    tm       <-   length(males)                                   # -- count male lengths
    mLm      <-   format(round(mean(males,na.rm=T),1),nsmall=1)   # -- mean male length
    stdm     <-   round(sd(males),1)                              # -- standard deviation
 
    # --  StRS year one by spatial and depth strata:  count/mean of samples for fork length and tagged fish fork lengths
     bio      <-   paste(" select locality, depth, PropMales, PropFemales, ",
                         " MalesMnFkLen, FemalesMnFkLen, TaggedMnFkLen ",
                         " from gfbio_sable_bio_summary ",
                         " where depth is not null and year = ",yr,
                         " order by Locality,Depth", sep="")
     #biosumm  <-   GetSQLData(bio,"Sablefish")
     #write.table(biosumm, file = paste(path,"results06.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",") 
     biosumm   <-    read.csv(paste(path,'results06.csv',sep=''),header=T) 

     colnames(biosumm) <-  c("Spatial","Depth","Males","Females","Males","Females","Tagged")
     

     #  -- sum the count of length values for the table columns
     biosumm[16,3]     <-  round((biosumm[1,3] + biosumm[2,3] + biosumm[3,3])/ 3, 2)  # --  males S1 average proportions
     biosumm[16,4]     <-  round((biosumm[1,4] + biosumm[2,4] + biosumm[3,4])/ 3, 2)  # --  females S1 average proportions
     biosumm[16,5]     <-  round((biosumm[1,5] + biosumm[2,5] + biosumm[3,5])/ 3, 0)  # --  males S1 average fork len
     biosumm[16,6]     <-  round((biosumm[1,6] + biosumm[2,6] + biosumm[3,6])/ 3, 0)  # --  females S1 average fork len 
     biosumm[16,7]     <-  round((biosumm[1,7] + biosumm[2,7] + biosumm[3,7])/ 3, 0)  # --  tagged S1 average fork len
      
     biosumm[17,3]     <-  round((biosumm[4,3] + biosumm[5,3] + biosumm[6,3])/ 3, 2)   # -- S2
     biosumm[17,4]     <-  round((biosumm[4,4] + biosumm[5,4] + biosumm[6,4])/ 3, 2)
     biosumm[17,5]     <-  round((biosumm[4,5] + biosumm[5,5] + biosumm[6,5])/ 3, 0)
     biosumm[17,6]     <-  round((biosumm[4,6] + biosumm[5,6] + biosumm[6,6])/ 3, 0)
     biosumm[17,7]     <-  round((biosumm[4,7] + biosumm[5,7] + biosumm[6,7])/ 3, 0)
      
     biosumm[18,3]     <-  round((biosumm[7,3] + biosumm[8,3] + biosumm[9,3])/ 3, 2)     # -- S3
     biosumm[18,4]     <-  round((biosumm[7,4] + biosumm[8,4] + biosumm[9,4])/ 3, 2)
     biosumm[18,5]     <-  round((biosumm[7,5] + biosumm[8,5] + biosumm[9,5])/ 3, 0)
     biosumm[18,6]     <-  round((biosumm[7,6] + biosumm[8,6] + biosumm[9,6])/ 3, 0)
     biosumm[18,7]     <-  round((biosumm[7,7] + biosumm[8,7] + biosumm[9,7])/ 3, 0)
      
     biosumm[19,3]     <-  round((biosumm[10,3] + biosumm[11,3] + biosumm[12,3])/ 3, 2)  # -- S4
     biosumm[19,4]     <-  round((biosumm[10,4] + biosumm[11,4] + biosumm[12,4])/ 3, 2)
     biosumm[19,5]     <-  round((biosumm[10,5] + biosumm[11,5] + biosumm[12,5])/ 3, 0)
     biosumm[19,6]     <-  round((biosumm[10,6] + biosumm[11,6] + biosumm[12,6])/ 3, 0) 
     biosumm[19,7]     <-  round((biosumm[10,7] + biosumm[11,7] + biosumm[12,7])/ 3, 0) 
      
     biosumm[20,3]     <-  round((biosumm[13,3] + biosumm[14,3] + biosumm[15,3])/ 3, 2)  # --S5
     biosumm[20,4]     <-  round((biosumm[13,4] + biosumm[14,4] + biosumm[15,4])/ 3, 2)
     biosumm[20,5]     <-  round((biosumm[13,5] + biosumm[14,5] + biosumm[15,5])/ 3, 0)
     biosumm[20,6]     <-  round((biosumm[13,6] + biosumm[14,6] + biosumm[15,6])/ 3, 0)  
     biosumm[20,7]     <-  round((biosumm[13,7] + biosumm[14,7] + biosumm[15,7])/ 3, 0)
      
     newdata           <-  rbind(biosumm[1:3,],   biosumm[16,], biosumm[4:6,],  biosumm[17,],
                                 biosumm[7:9,],   biosumm[18,], biosumm[10:12,],biosumm[19,], 
                                 biosumm[13:15,], biosumm[20,])   # r bind the average column results
     
     #colnames(newdata) <-  c("Spatial","Depth","Males","Females","Males","Females","Tagged")
     #write.table(newdata, file = paste(path,"table6a.csv",sep=''),row.names=FALSE, na="",col.names=TRUE, sep=",")
     #newdata$Spatial   <-  cleanf(newdata$Spatial)
     #write.table(newdata, file = paste(path,"table6.csv",sep=''),row.names=FALSE, na="",col.names=TRUE, sep=",")
     a <-"the spatial strata S~1~, S~2~, S~3~, S~4~ and S~5~"
     
     pdiffS1 <- biosumm[16,3] - biosumm[16,4]    # --  S1 check male - female prop
     pS1     <- sum(pdiffS1 < 0.00)
     if (pS1 == 1)  {wS1="S~1~, "} else {wS1=""} # --  if value negative, more females
      
     pdiffS2 <- biosumm[17,3] - biosumm[17,4]    #  -- S2 check male - female prop
     pS2 <- sum(pdiffS2 < 0.00)
     if (pS2 == 1)  {wS2="S~2~, "} else {wS2=""} 
      
     pdiffS3 <- biosumm[18,3] - biosumm[18,4]    # --  S3 check male - female prop
     pS3 <- sum(pdiffS3 < 0.00)
     if (pS3 == 1)  {wS3="S~3~, "} else {wS3=""}
      
     pdiffS4 <- biosumm[19,3] - biosumm[19,4]    # -- S4 check male - female prop
     pS4 <- sum(pdiffS4 < 0.00)
     if (pS4 == 1)  {wS4="S~4~, "} else {wS4=""}
      
     pdiffS5 <- biosumm[20,3] - biosumm[20,4]    # -- S4 check male - female prop
     pS5 <- sum(pdiffS5 < 0.00)
     if (pS5 == 1)  {wS5="S~5~, "} else {wS5=""}
      
     stratafem    <- paste(wS1,wS2,wS3,wS4,wS5,sep="")         # -- list of S areas where more females
     stratafema   <- substr(stratafem, 1, nchar(stratafem)-2)  # -- trim trailing comma
     stratafemale <- sub(",([^,]*)$", " and\\1", stratafema)   # -- replace last comma with and
     stratafemale <- paste('the spatial strata ',stratafemale, sep="")
     if(stratafemale==a){stratafemale="all spatial strata (S~1~ - S~5~)"}

     #  More females than males were seen in the shallow depth stratum as per yearly trend...
     shallS1 <- sum((biosumm[1,3] - biosumm[1,4])<0.00)
     
     if (shallS1 == 1)  {shallwS1="S~1~, "} else {shallwS1=""}
           shallS2 <- sum((biosumm[4,3] - biosumm[4,4])<0.00)
           
     if (shallS2 == 1)  {shallwS2="S~2~, "} else {shallwS2=""}
           shallS3 <- sum((biosumm[7,3] - biosumm[7,4])<0.00)
            
     if (shallS3 == 1)  {shallwS3="S~3~, "} else {shallwS3=""}      
           shallS4 <- sum((biosumm[10,3] - biosumm[10,4])<0.00)
            
     if (shallS4 == 1)  {shallwS4="S~4~, "} else {shallwS4=""}  
           shallS5 <- sum((biosumm[13,3] - biosumm[13,4])<0.00)
            
     if (shallS5 == 1)  {shallwS5="S~5~, "} else {shallwS5=""}
            
     shallsfem    <- paste(shallwS1,shallwS2,shallwS3,shallwS4,shallwS5,sep="")
     shallsfema   <- substr(shallsfem, 1, nchar(shallsfem)-2)  # -- trim trailing comma
     shallsfemale <- sub(",([^,]*)$", " and\\1", shallsfema)   # -- replace last comma with and
     shallsfemale <- paste('the spatial strata ',shallsfemale, sep="") 
     if(shallsfemale==a){shallsfemale="all spatial strata (S~1~ - S~5~)"}
     
     # -- Assumption that more males than females were seen in the mid depth stratum
     midS1 <- sum((biosumm[2,3] - biosumm[2,4])>0.00)
      
      if (midS1 == 1)  {midwS1="S~1~, "} else {midwS1=""}
          midS2 <- sum((biosumm[5,3] - biosumm[5,4])>0.00)
      
      if (midS2 == 1)  {midwS2="S~2~, "} else {midwS2=""}
            midS3 <- sum((biosumm[8,3] - biosumm[8,4])>0.00)
      
      if (midS3 == 1)  {midwS3="S~3~, "} else {midwS3=""}      
          midS4 <- sum((biosumm[11,3] - biosumm[11,4])>0.00)
      
      if (midS4 == 1)  {midwS4="S~4~, "} else {midwS4=""}  
            midS5 <- sum((biosumm[14,3] - biosumm[14,4])>0.00)
      
      if (midS5 == 1)  {midwS5="S~5~, "} else {midwS5=""}
            
      midsm    <- paste(midwS1,midwS2,midwS3,midwS4,midwS5,sep="")
      midsma   <- substr(midsm, 1, nchar(midsm)-2)      # -- trim trailing comma
      midsmale <- sub(",([^,]*)$", " and\\1", midsma)   # -- replace last comma with and
      
      # -- Assumption that more females than males were seen in the deep depth stratum
      deepS1 <- sum((biosumm[3,3] - biosumm[3,4])<0.00)
      if (deepS1 == 1)  {deepwS1="S~1~, "} else {deepwS1=""}
      deepS2 <- sum((biosumm[6,3] - biosumm[6,4])<0.00)
      if (deepS2 == 1)  {deepwS2="S~2~, "} else {deepwS2=""}
      deepS3 <- sum((biosumm[9,3] - biosumm[9,4])<0.00)
      if (deepS3 == 1)  {deepwS3="S~3~, "} else {deepwS3=""}      
      deepS4 <- sum((biosumm[12,3] - biosumm[12,4])<0.00)
      if (deepS4 == 1)  {deepwS4="S~4~, "} else {deepwS4=""}  
      deepS5 <- sum((biosumm[15,3] - biosumm[15,4])<0.00)
      if (deepS5 == 1)  {deepwS5="S~5~, "} else {deepwS5=""}
      deepsfem    <- paste(deepwS1,deepwS2,deepwS3,deepwS4,deepwS5,sep="")
      deepsfema   <- substr(deepsfem, 1, nchar(deepsfem)-2)   # trim trailing comma
      deepsfemale <- sub(",([^,]*)$", " and\\1", deepsfema)   # replace last comma with and
 
   # -- other fish counts
     othfish      <-   paste(" select species_name, SUM(Sample_count) AS counter  ",
                             " from dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH ",
                             " where (Year = ", yr, ") group by species_name, species ",
                             " order by species", sep="")
     #otherfish    <-   GetSQLData(othfish,"Sablefish")
     #write.table(otherfish, file = paste(path,"results07.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")      
     otherfish    <-   read.csv(paste(path,'results07.csv',sep=''),header=T)
     
     # fyi - list of tagged fish retained for sampling
     tagSample  <-  paste(" select TAG_ID, RELEASE_YR, RECOVERY_YR, RELEASE_TAG, RECOVERY_TAG, ",
                          " PREVIOUS_TAG_NUMBER, RELEASE_EVENT, RECOVERY_EVENT, Release_Length, ",
                          " Recovery_Length, REL_MAJOR, REL_LAT, REL_LON, REC_LAT, ",
                          " REC_LON, REC_SEAM, REC_MAJOR, DISTANCE, RECOVERY_MONTH, ",
                          " lineseg, SEAMOUNT_IND, RECAPTURE_FISH_ID, RECOVERY_STATE_DESC, event_set ",
                          " from dbo.GIS_Release_Recovery_Distance_vw AS GIS_Release_Recovery_Distance_vw_2 ",
                          " where (RECOVERY_YR = 2022) and (RECOVERY_STATE_DESC='fresh') ",
                          " order by event_set", sep="")
     #tag.samples    <-   GetSQLData(tagSample,"Sablefish")
     #write.table(tag.samples, file = paste(path,"results07b.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")      
     tag.samples    <-   read.csv(paste(path,'results07b.csv',sep=''),header=T)                    
    

```

```{r basketFateWords, echo=FALSE}
   # use data from Appendix D
   options(knitr.kable.NA = '')
   #trap       <- paste("dbo.procRReport_Survey_TrapUse ",yr,",1,",setcnt, sep="")
   #trap.dat    <- GetSQLData(trap,"Sablefish")
   #write.table(trap.dat, file = paste(path,'appendixD.csv',sep=''),row.names=FALSE,na="",col.names=TRUE,sep=",")  
   trap.dat    <- read.csv(paste(path,'appendixC.csv',sep=''),header=T)
   
   trap.Usage    <- trap.dat[,c(-1)]      # delete trip_id
   trap.Usage    <- trap.Usage[,c(-28)]   # delete Trap 27, there are many sets with 26 traps in 2021

   trap.Usage    <- dplyr::mutate(trap.Usage, A = rowSums(trap.Usage == "A", na.rm = TRUE))  # add up A's
   trap.Usage    <- dplyr::mutate(trap.Usage, AF = rowSums(trap.Usage == "A,F", na.rm = TRUE)) 
   trap.Usage$A2 <- trap.Usage$A + trap.Usage$AF
   
   trap.Usage    <- dplyr::mutate(trap.Usage, D = rowSums(trap.Usage == "D", na.rm = TRUE))  # add up D's     
   trap.Usage    <- dplyr::mutate(trap.Usage, DF = rowSums(trap.Usage == "D,F", na.rm = TRUE))  
   trap.Usage$D2 <- trap.Usage$D + trap.Usage$DF  
   
   trap.Usage    <- dplyr::mutate(trap.Usage, T = rowSums(trap.Usage == "T", na.rm = TRUE))  # add up T's
   trap.Usage    <- dplyr::mutate(trap.Usage, TF = rowSums(trap.Usage == "T,F", na.rm = TRUE))  
   trap.Usage$T2 <- trap.Usage$T + trap.Usage$TF     
   
   trap.Usage    <- dplyr::mutate(trap.Usage, N = rowSums(trap.Usage == "" , na.rm = TRUE))  # add up Nulls
   trap.Usage$N  <- trap.Usage$N-1

   trap.Usage    <- trap.Usage[,c(-28,-29,-31,-32,-34,-35)]  # trim unnecessary columns
   trap.Usage    <- trap.Usage[c(-7,-14,-27,-63),]

   names(trap.Usage)  <-  c("Set","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17",
                                  "18","19","20","21","22","23","24","25","26", "A","D","T","-")
```
   
## SABLEFISH SAMPLING

A detailed breakdown of the fate of the Sablefish catch in each trap for the `r yr` survey is listed in Appendix \@ref(app:fourth-appendix).  Over all sets, `r sum(trap.Usage$A)` traps with Sablefish were sampled and `r sum(trap.Usage$T)` traps with Sablefish were tagged.

During the `r yr` StRS survey component, a total of `r format(countStRS[3,2], big.mark=",")` Sablefish were caught.   Of that total, `r format(countStRS[3,5], big.mark=",")` were tagged and released and `r format(countStRS[3,7], big.mark=",")` were retained for biological sampling. Of the tagged fish, `r countStRS[3,3]` were previously tagged fish that were re-released with a new tag. There were `r countStRS[3,4]` previously tagged fish retained for sampling (Appendix \@ref(app:fifth-appendix)).

Out of the `r format(countStRS[1,2], big.mark=",")` Sablefish captured during the `r yr` traditional survey component (inlet standardized sets), `r format(countStRS[1,5], big.mark=",")` were tagged and released, `r format(countStRS[1,7], big.mark=",")` were used for biological sampling and `r format(countStRS[1,3], big.mark=",")` were previously tagged fish re-released with a new tag (Appendix \@ref(app:fifth-appendix)). 

The four dedicated 60-trap gear movement sets that deployed cameras captured `r format(countStRS[2,2], big.mark=",")` Sablefish.  Sublegal Sablefish and other species were returned to the water, except for those fish permitted for retention under the Section 52 licence.  There were `r countStRS[2,4]` previously tagged fish retained for sampling (Appendix \@ref(app:fifth-appendix)).

Overall, the StRS sets had a higher proportion of females than males over `r stratafemale`.  More females than males were caught in the shallow depth stratum (RD~1~) within `r shallsfemale`.  In the mid depth stratum (RD~2~), there were more males than females in `r midsmale`.  The deepest depth stratum (RD~3~) saw more females in spatial strata `r deepsfemale` (Table \@ref(tab:table6)).  

## SABLEFISH FORK LENGTH

Differences in length distributions between female and male Sablefish are exhibited in the data collected from the StRS portion of the 2003 - `r yr` surveys. Over these `r yr-2003 +1` years, the mean fork length ($\bar{x}$)  was `r mLf` cm for females and `r mLm` cm for males (Figure \@ref(fig:figure11)).

In `r yr`, the average mean fork length for the `r format(length(firstyrfem$sex), big.mark=",")` females was `r as.character(round(mean(firstyrfem$length),1))` cm  and the average mean fork length for the `r format(length(firstyrmal$sex), big.mark=",")` males was `r as.character(round(mean(firstyrmal$length),1))` cm.  The average length of males reached their lowest mean size since 2003 (Figure \@ref(fig:figure12)). 

On average, female Sablefish grow faster and reach a far greater size (Figure \@ref(fig:figure13) a) compared to males (Figure \@ref(fig:figure13) b).

## SABLEFISH MATURITY

Sablefish maturity stages are macroscopically identified ...(Figure \@ref(fig:figure14)).

## SABLEFISH SUB-LEGAL ENCOUNTERS

```{r SablefishAgesText, echo=FALSE}
   # -- provides values for inline text, important to know the last year of ages completed
   # -- sql server procedure:  procRReport_Survey_proportions_at_age which pulls age data from 
   # -- GFBIOSQL.dbo.b21_samples and b22_specimens

   age         <-  paste("select Female_Yr_Total,Age from Report_Survey_GFBIO_Age_MF_Prop where ", 
                         "SetType='StRS' and f=1 and Year=",yr-1,sep="")
   #agedat      <-  GetSQLData(age,"Sablefish")    # --  female age total and count of most aged text captions
   #write.table(agedat, file = paste(path,"results08.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")   
   agedat      <-  read.csv(paste(path,'results08.csv',sep=''),header=T)
   
   oldageF     <-  "exec procRReport_Survey_oldAgeFish 2, 2021"  # -- oldest female text caption
   #oldageFem   <-  GetSQLData(oldageF,"Sablefish")
   #write.table(oldageFem, file = paste(path,"results09.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")    
   oldageFem   <-  read.csv(paste(path,'results09.csv',sep=''),header=T)
   
   oldageM     <-  "exec procRReport_Survey_oldAgeFish 1, 2021"  # -- oldest male text caption
   #oldageMale  <-  GetSQLData(oldageM,"sablefish") 
   #write.table(oldageMale, file = paste(path,"results10.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")   
   oldageMale  <-  read.csv(paste(path,'results10.csv',sep=''),header=T) 
   
   oldFem      <-  oldageFem[1,2]                # -- oldest female age
   oldFemYr    <-  oldageFem[1,3]                # -- year captured
   oldMale     <-  oldageMale[1,2]               # -- oldest male age
   oldMaleYr   <-  oldageMale[1,3]               # -- year captured
   
```

More than half of the sub-legal specimens were captured in the mid-depth waters of i) the northern strata of S~4~ and S~5~ in 2017 and 2018, ii) all spatial strata in 2019, iii) S~1~, S~4~ and S~5~ in 2020, and iv) S~1~, S~2~, S~3~ and S~5~ in 2021 (Figure \@ref(fig:figure15)).

``` {r RecoveredTaggedFish,}
      tag  <- paste("select * from Report_Survey_Tag_Recoveries",sep="") # have to go in database and change the year value
      #tag.rec <- GetSQLData(tag,"FishTag")
      #write.table(tag.rec, file = paste(path,"table7.csv",sep=''),row.names=FALSE, na="",col.names=TRUE, sep=",")
      tag.rec <-  read.csv(paste(path,'table7.csv',sep=''), header=T)
      
      tag.rec[is.na(tag.rec)] <- 0   # convert NA to zero in whole table
      tag.rec$YearGroups      <- as.character(tag.rec$YearGroups)  # change column to character
      tag.rec$YearGroups      <- gsub("Grp1.", "", tag.rec$YearGroups)
      tag.rec$YearGroups      <- gsub("Grp2.", "", tag.rec$YearGroups)
      tag.rec$YearGroups      <- gsub("Grp3.", "", tag.rec$YearGroups)  
      tag.rec$YearGroups      <- gsub("Grp4.", "", tag.rec$YearGroups)      
      tag.rec$Recoveries      <- as.numeric(rowSums(tag.rec[,2:8], na.rm=TRUE))
      
```

## RECOVERED TAGGED SABLEFISH

Of the `r sum(tag.rec$Recoveries)` Canadian tagged fish that were recovered on the survey, the majority (`r round((sum(tag.rec$X.10.km) + sum(tag.rec$X11.50.km))/ sum(tag.rec$Recoveries) * 100)`%) had travelled no more than 50 kilometers from the release site.  More than half of the recoveries (`r round((tag.rec$Recoveries[1] + tag.rec$Recoveries[2]) / sum(tag.rec$Recoveries) * 100)`%) were recaptured within 5 years at liberty (Table \@ref(tab:table7)).  

```{r OtherFishText, echo=FALSE}
   # data from APPENDIX F (run first)
   otherspecRE  <-  read.csv(paste(path,'appendixE.csv',sep=''),header=T) # read from appendix F, rougheye biosamples
   otherspecRE[is.na(otherspecRE)] <- 0
   rebs.count  <-  sum(otherspecRE$Sample_count)
   re.count    <-  sum(otherspecRE$'Rougheye')
   bs.count    <-  sum(otherspecRE$'Blackspotted')
   hy.count    <-  sum(otherspecRE$'Hybrid')
 #  if (hy.count==0) {hy.count ='none'}
   
   otherspec  <-  read.csv(paste(path,'appendixF.csv',sep=''),header=T) # read from appendix G biosamples
   species.names  <-  unique(otherspec$species_name)  
   len.sp.cnt     <-  length(species.names)

   total <- ""
    for (i in c(len.sp.cnt:1)) {
        if (i==len.sp.cnt-1){
            addition <- paste(stringr::str_to_title(species.names[i]),", and ", sep="")}  # add 'and'
        else { 
            addition <- paste(stringr::str_to_title(species.names[i]),", ", sep="")}  # add comma between species
        
            total    <- paste(addition,total,sep="")
     }
     #total    <- gsub("pacific","Pacific", total)    # replace small p with capital
     total.string <- strtrim(total,nchar(total)-2)   # trim string

   
```
## OTHER FISH SAMPLING

Length, sex, maturity, otoliths and DNA samples were collected for `r rebs.count` Rougheye/Blackspotted Rockfish specimens.  The science samplers visually identified `r re.count` specimens as Rougheye, `r bs.count` specimens as Blackspotted and `r hy.count` specimen as a hybrid species (Appendix \@ref(app:sixth-appendix)).

Length, sex, maturity and otoliths were collected for `r total.string` (Appendix \@ref(app:seventh-appendix)).

## SABLEFISH AGES

The highest proportion of female ages in StRS sets for 2003 through to 2010 were 3, 4, 5, 6, 7, 8, 9 and 10 years of age,
respectively. Then, another cohort appeared in 2011 through to 2015, showing up as 3, 4, 5, 6 and 7 year olds. In 2016, 2017 and 2018 the highest proportion of female Sablefish were ages 3, 4, and 5 year olds.  Last, the years 2019, 2020 and 2021 were dominated by 3, 4 and 5 year old female Sablefish, respectively (Figure \@ref(fig:figure16) a).  This pattern suggests a large 2016 recruitment event with fish from this cohort dominating StRS catch in recent years.

The highest proportion of male ages in StRS sets for 2003 through to 2011 were 3, 5, 5, 6, 8, 8, 8, 10 and 12 years of age, respectively. Another cohort dominated StRS catch starting in 2012, appearing first as 4 year olds in 2012, followed by 5 year olds in 2013, 7 year olds in 2014,  7 year olds in 2015 and 8 year olds in 2016.  The years 2019, 2020 and 2021 were represented by 3, 4 and 5 year old males, respectively (Figure \@ref(fig:figure16) b), as was seen for females.

The maximum reported age in B.C. for females is `r oldFem` years,  collected in `r oldFemYr`.  The maximum reported age in B.C. for males is `r oldMale` years,  collected in `r oldMaleYr`. 

```{r SablefishOceanText, echo=FALSE}

     #  average depth and average temperature by set for year, data from figure 15
     sbecp     <- paste("select * from SEABIRD_ReportCoplot where Year in(",yr,")",sep="")
     #ctddat    <- GetSQLData(sbecp,"Sablefish")   # read from SQL Server
     #write.table(ctddat, file = paste(path,"figure17.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")      
      
     ctddat    <- read.csv(paste(path,'figure17.csv',sep=''),header=T)  # read from csv
     coldest   <- min(ctddat$temperature)
     deepcold  <- ctddat[ which(ctddat$temperature==coldest ), ]
     
     # data from figure 18  
     celcius      <- read.csv(paste(path,'figure18.csv',sep=''), header=T)
     celcius$depth_stratum  <-  trimws(celcius$depth_stratum)   # trim whitespace

     shallow.temp <- celcius[celcius$depth_stratum=="RD1",]
     mid.temp     <- celcius[celcius$depth_stratum=="RD2",]        
     deep.temp    <- celcius[celcius$depth_stratum=="RD3",]        
       
     celcius.max <-  max(shallow.temp$Avgtemp)
     celcius.max.shallow <- shallow.temp[shallow.temp$Avgtemp==celcius.max,]
     
     celcius.max <-  max(mid.temp$Avgtemp)
     celcius.max.mid <-mid.temp[mid.temp$Avgtemp==celcius.max,]
     
     celcius.max <-  max(deep.temp$Avgtemp)
     celcius.max.deep <-deep.temp[deep.temp$Avgtemp==celcius.max,]  
     
     celcius.min <-  min(shallow.temp$Avgtemp)
     celcius.min.shallow <-shallow.temp[shallow.temp$Avgtemp==celcius.min,]
     
     celcius.min <-  min(mid.temp$Avgtemp)
     celcius.min.mid <-mid.temp[mid.temp$Avgtemp==celcius.min,]
     
     celcius.min <-  min(deep.temp$Avgtemp)
     celcius.min.deep <-deep.temp[deep.temp$Avgtemp==celcius.min,]
     
```


## OCEANOGRAPHIC TEMPERATURES AND DEPTHS

As with previous years, the `r yr` survey data exhibited a trend of decreasing temperature with depth over 1-degree latitude intervals from southwest Vancouver Island to northwest Haida Gwaii (Figure \@ref(fig:figure17)).

SBE 39 recorders have been deployed on survey fishing sets since 2006. In the shallow waters, the lowest average temperature of `r round(celcius.min.shallow[1,5],2)` $^\circ$C  was recorded in `r celcius.min.shallow[1,1]` (latitude zone `r celcius.min.shallow$lat`$^\circ$ - `r celcius.min.shallow$lat+1`$^\circ$); the highest average temperature was `r round(celcius.max.shallow[1,5],2)` $^\circ$C in `r celcius.min.shallow[1,1]` (`r celcius.max.shallow$lat`$^\circ$ - `r celcius.max.shallow$lat+1`$^\circ$). In the mid-depth waters, the lowest average temperature was `r round(celcius.min.mid[1,5],2)` $^\circ$C in `r celcius.min.mid[1,1]` (`r celcius.min.mid$lat`$^\circ$ - `r celcius.min.mid$lat+1`$^\circ$); the highest average temperature was `r round(celcius.max.mid[1,5],2)` $^\circ$C in `r celcius.max.mid[1,1]` (`r celcius.max.mid$lat`$^\circ$ - `r celcius.max.mid$lat+1`$^\circ$). In the deepest waters, the lowest average temperature was `r round(celcius.min.deep[1,5],2)` $^\circ$C in `r celcius.min.deep[1,1]` (`r celcius.min.deep$lat`$^\circ$ - `r celcius.min.deep$lat+1`$^\circ$) and the highest average temperature was `r round(celcius.max.deep[1,5],2)`$^\circ$C  in `r celcius.min.deep[1,1]` (`r celcius.max.deep$lat`$^\circ$ - `r celcius.max.deep$lat+1`$^\circ$) (Figure \@ref(fig:figure18)).


```{r acknowledge, echo=FALSE}

    names  <-  paste(" select keyid, Association, year, Names from dbo.ReportSurvey_Acknowlegdements where year=", yr, sep="")
    #credits    <-  GetSQLData(names,"Sablefish")
    #write.table(credits, file = paste(path,"results13.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",") 
    credits    <-  read.csv(paste(path,'results13.csv',sep=''),header=T) 
    
```    
                                                                                                        
## ACKNOWLEDGEMENTS

We are grateful for the review of this document provided by xx and xx.  The stock assessment survey and data report is the result of the collaborative efforts of many individuals.  The Canadian Sablefish Association has provided coordination and support of the annual Sablefish survey since 1994.  The scientific staff that conducted the `r yr` Sablefish research charter included `r credits[2,4]` of Archipelago Marine Research Ltd (AMR); `r credits[3,4]` of Fisheries and Oceans, Canada.  

A special thanks to the Vessel Master and crew of the F/V `r boat`, whose hard work made the survey successful.  In `r yr`, the crew consisted of `r credits[1,4]`.

\clearpage


